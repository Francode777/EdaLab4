import java.util.List;
import java.util.Stack;
import java.util.Random;

public class Patient {//requiere atencion medica
    private String name;
    private String lastName;
    private String fullName = name + " " + lastName;
    private String ID;
    private int categoria;
    private long arrivalTime;
    private String state;// en_espera, en_atencion, atendido
    private String area;// valor donde debe ser atendido
    private Stack<String> changeHistory;//vera la categoria que ira cambaidno el paciente

    Patient(String name, String lastName, String ID, long arrivalTime, String area) {
        this.name = name;
        this.lastName = lastName;
        this.ID = ID;
        this.arrivalTime = arrivalTime;
        this.state = "En espera";
        this.changeHistory = new Stack<>();
        this.area = area;
        Random rand = new Random();

        int rango = rand.nextInt(1,101);

        if (rango <= 10)// 10%
            this.categoria = 1;
        else if (rango <= 25)// 15%
            this.categoria = 2;
        else if (rango <= 43)// 18%
            this.categoria = 3;
        else if (rango <= 70)// 27%
            this.categoria = 4;
        else // 30%
            this.categoria = 5;

    }

    //metodos
    public String getName() {
        return name;
    }
    public String getLastName() {
        return lastName;
    }
    public String getID(){
        return ID;
    }
    public int getCategoria(){
        return categoria;
    }
    public long getArrivalTime(){
        return arrivalTime;
    }
    public String getArea() {
        return area;
    }
    public String getState() {
        return state;
    }
    public void setArea(String area) {
        this.area = area;
    }
    public void setCategory(int newCategory) {
        categoria = newCategory;
    }
    public void setState (int newState) {
        String[] estados = {"En atencion", "Atendido"};
        if (newState >= 0 && newState < estados.length) {
            this.state = estados[newState];
        } else {
            throw new IllegalArgumentException("Estado inválido: " + newState);
        }
    }
    public long curretTimeout(){// relacion con WorkingDay
        return System.currentTimeMillis() - arrivalTime;
    }
    public String  getLastChange(){//obtiene y remueve el ultimo cambio
        if(changeHistory.size() > 0)
            return changeHistory.pop();
        else
            return "No se encuentran cambios disponibles";
    }
    public void recordChange(int categoria){
        if(categoria == -1) {
            changeHistory.push("Paciente en atencion ");
        }else if(categoria == -2){
            changeHistory.push("Paciente atendido");
        }else if(categoria > 0 && categoria < 6){
            changeHistory.push("cambio de categoria: C" + categoria);
        }else{
            throw new IllegalArgumentException("Estado inválido: " + categoria);
        }
    }



}
